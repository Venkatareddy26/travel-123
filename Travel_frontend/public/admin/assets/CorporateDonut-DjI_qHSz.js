import{R as r,j as a}from"./index-B4FkT-MR.js";function J({data:M=[],colors:k=[],size:n=220,onSliceClick:S}){var F;const g=Math.max(24,Math.floor(n/2-40)),I=Math.max(12,Math.floor(n*.12)),s=n/2,c=n/2,f=2*Math.PI*g,i=(M||[]).reduce((t,e)=>t+(e.value||0),0)||1,[P,y]=r.useState(null),[b,q]=r.useState(null),[h,D]=r.useState(!1),[m,A]=r.useState({visible:!1,x:0,y:0,text:""}),[H,B]=r.useState(0),$=r.useRef(null),l=typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;r.useEffect(()=>{if(l){D(!0),B(i);return}const t=setTimeout(()=>D(!0),16);return()=>clearTimeout(t)},[i,l]),r.useEffect(()=>{if(!h||l)return;const t=0,e=i,x=500;let o=null;const u=performance.now();function p(R){const v=Math.min(1,(R-u)/x),j=1-Math.pow(1-v,3);B(Math.round(t+(e-t)*j)),v<1&&(o=requestAnimationFrame(p))}return o=requestAnimationFrame(p),()=>o&&cancelAnimationFrame(o)},[h,i,l]);function w(t,e,x){if(!$.current)return;const o=$.current.getBoundingClientRect();A({visible:!0,x:t.clientX-o.left+12,y:t.clientY-o.top+12,text:`${e.name}: ${e.value} (${(e.value/i*100).toFixed(1)}%)`})}function C(){A({visible:!1,x:0,y:0,text:""}),y(null)}let E=0;return a.jsxs("div",{ref:$,className:"pie-wrap",style:{width:n,height:n,display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},tabIndex:0,role:"region","aria-label":"Donut chart",children:[a.jsxs("svg",{width:n,height:n,viewBox:`0 0 ${n} ${n}`,"aria-hidden":!1,children:[a.jsx("g",{style:{transformOrigin:`${s}px ${c}px`,transition:"transform 360ms cubic-bezier(.22,.9,.3,1)"},transform:h?void 0:`translate(${s},${c}) scale(0.95)`,children:a.jsx("g",{transform:`translate(${s},${c}) rotate(-90)`,children:(M||[]).map((t,e)=>{const x=(t.value||0)/i,o=Math.max(1e-4,x*f),u=E,p=`${o} ${f-o}`,R=l||h?-u:f-u;E+=o;const v=P===e,j=b===e,T=((u/f+o/f/2)*360-90)*Math.PI/180,L=v?12:j?6:0,N=Math.cos(T)*L,O=Math.sin(T)*L;return a.jsx("g",{transform:`translate(${N},${O})`,style:{transition:"transform 180ms ease, opacity 220ms ease"},children:a.jsx("circle",{r:g,fill:"none",stroke:k[e%k.length]||"var(--accent)",strokeWidth:I,strokeDasharray:p,strokeDashoffset:R,strokeLinecap:"butt",onMouseEnter:d=>{y(e),w(d,t)},onMouseMove:d=>w(d,t),onMouseLeave:()=>C(),onFocus:d=>{y(e);const V={clientX:d.target.getBoundingClientRect().left+8,clientY:d.target.getBoundingClientRect().top+8};w(V,t)},onBlur:()=>C(),onClick:()=>{q(e),S&&S(t,e)},role:"button",tabIndex:0,"aria-label":`${t.name}: ${t.value}`,style:{cursor:"pointer",transition:l?"none":"stroke-dashoffset 700ms cubic-bezier(.22,.9,.3,1)"}})},t.name||e)})})}),a.jsx("circle",{cx:s,cy:c,r:Math.max(6,g-I/2),fill:"var(--card)",stroke:"rgba(0,0,0,0.04)"}),a.jsx("text",{x:s,y:c-6,textAnchor:"middle",fontSize:Math.max(10,Math.floor(n*.055)),fill:"var(--card-text)",fontWeight:700,children:H}),a.jsx("text",{x:s,y:c+12,textAnchor:"middle",fontSize:Math.max(9,Math.floor(n*.035)),fill:"var(--muted)",children:b!==null?(F=M[b])==null?void 0:F.name:"Total"})]}),m.visible&&a.jsx("div",{className:"pie-tooltip",style:{position:"absolute",left:m.x,top:m.y,pointerEvents:"none",background:"rgba(0,0,0,0.85)",color:"#fff",padding:"6px 8px",borderRadius:6,fontSize:12,whiteSpace:"nowrap"},children:m.text})]})}export{J as default};
