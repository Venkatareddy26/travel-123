import{u as M,r as l,j as e}from"./index-B4FkT-MR.js";const g="http://localhost:5000",f=[{id:"passport",label:"Passport",icon:"ðŸ›‚",color:"#6366f1"},{id:"visa",label:"Visa",icon:"ðŸ“‹",color:"#8b5cf6"},{id:"vaccine",label:"Vaccine Certificate",icon:"ðŸ’‰",color:"#10b981"},{id:"insurance",label:"Travel Insurance",icon:"ðŸ›¡ï¸",color:"#f59e0b"},{id:"id_card",label:"ID Card",icon:"ðŸªª",color:"#06b6d4"},{id:"other",label:"Other",icon:"ðŸ“„",color:"#64748b"}];function S(r){return r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"â€”"}function N(r){if(!r)return!1;const m=(new Date(r)-new Date)/(1e3*60*60*24);return m>0&&m<=30}function w(r){return r?new Date(r)<new Date:!1}function V(){const r=M(),m=l.useRef(null),[u,x]=l.useState([]),[E,D]=l.useState(!0),[T,y]=l.useState(!1),[d,b]=l.useState(null),[j,U]=l.useState("all"),[v,P]=l.useState(""),[a,o]=l.useState({type:"passport",name:"",expiry:"",notes:"",file:null});async function p(){try{D(!0);const s=await fetch(`${g}/api/documents`);if(s.ok){const t=await s.json();t.success&&x(t.documents||[])}}catch(s){console.warn("Failed to fetch documents",s)}finally{D(!1)}}l.useEffect(()=>{p()},[]);async function $(){if(!a.name){alert("Please enter document name");return}try{const s=new FormData;s.append("name",a.name),s.append("type",a.type),s.append("expiry",a.expiry||""),s.append("notes",a.notes||""),a.file&&s.append("file",a.file);const t=await fetch(`${g}/api/documents`,{method:"POST",body:s});if(t.ok)(await t.json()).success&&(await p(),c(),alert("Document uploaded successfully!"));else{const n={id:Date.now(),name:a.name,type:a.type,expiry:a.expiry,notes:a.notes,createdAt:new Date().toISOString(),status:"active"};x(i=>[n,...i]),c(),alert("Document saved locally")}}catch{const t={id:Date.now(),name:a.name,type:a.type,expiry:a.expiry,notes:a.notes,createdAt:new Date().toISOString(),status:"active"};x(n=>[t,...n]),c()}}async function A(){if(d)try{(await fetch(`${g}/api/documents/${d.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a.name,type:a.type,expiry:a.expiry,notes:a.notes})})).ok?await p():x(t=>t.map(n=>n.id===d.id?{...n,...a}:n)),c()}catch{x(t=>t.map(n=>n.id===d.id?{...n,...a}:n)),c()}}async function F(s){if(window.confirm("Delete this document?"))try{(await fetch(`${g}/api/documents/${s}`,{method:"DELETE"})).ok?await p():x(n=>n.filter(i=>i.id!==s))}catch{x(n=>n.filter(i=>i.id!==s))}}function k(){b(null),o({type:"passport",name:"",expiry:"",notes:"",file:null}),y(!0)}function O(s){b(s),o({type:s.type||"passport",name:s.name||"",expiry:s.expiry?s.expiry.split("T")[0]:"",notes:s.notes||"",file:null}),y(!0)}function c(){y(!1),b(null),o({type:"passport",name:"",expiry:"",notes:"",file:null})}const C=u.filter(s=>{var t;return!(j!=="all"&&s.type!==j||v&&!((t=s.name)!=null&&t.toLowerCase().includes(v.toLowerCase())))}),h={total:u.length,expiring:u.filter(s=>N(s.expiry)).length,expired:u.filter(s=>w(s.expiry)).length,valid:u.filter(s=>s.expiry&&!w(s.expiry)&&!N(s.expiry)).length},L=s=>f.find(t=>t.id===s)||f[5];return e.jsx("div",{className:"min-h-screen font-sans",style:{backgroundColor:"#f8fafc"},children:e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsx("header",{className:"mb-8",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"Documents & Compliance"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Store passports, visas, vaccine certs, insurance & validate per policy"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:k,className:"px-5 py-2.5 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors flex items-center gap-2",children:[e.jsx("span",{children:"+"})," Upload Document"]}),e.jsx("button",{onClick:()=>r(-1),className:"px-4 py-2.5 border border-gray-200 rounded-lg text-gray-600 hover:bg-gray-50",children:"â† Back"})]})]})}),e.jsxs("section",{className:"grid grid-cols-4 gap-4 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-xl",style:{background:"linear-gradient(135deg, #6366f1, #8b5cf6)",color:"white"},children:"ðŸ“"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-slate-800",children:h.total}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Documents"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-xl",style:{background:"linear-gradient(135deg, #10b981, #059669)",color:"white"},children:"âœ“"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-slate-800",children:h.valid}),e.jsx("div",{className:"text-sm text-gray-500",children:"Valid"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-xl",style:{background:"linear-gradient(135deg, #f59e0b, #d97706)",color:"white"},children:"âš "}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-slate-800",children:h.expiring}),e.jsx("div",{className:"text-sm text-gray-500",children:"Expiring Soon"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-xl",style:{background:"linear-gradient(135deg, #ef4444, #dc2626)",color:"white"},children:"âœ•"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-slate-800",children:h.expired}),e.jsx("div",{className:"text-sm text-gray-500",children:"Expired"})]})]})})]}),e.jsx("section",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm mb-6",children:e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx("input",{type:"text",placeholder:"Search documents...",value:v,onChange:s=>P(s.target.value),className:"w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Filter:"}),e.jsxs("select",{value:j,onChange:s=>U(s.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"all",children:"All Types"}),f.map(s=>e.jsx("option",{value:s.id,children:s.label},s.id))]})]})]})}),e.jsx("section",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E?e.jsx("div",{className:"col-span-full text-center py-12 text-gray-400",children:"Loading documents..."}):C.length===0?e.jsxs("div",{className:"col-span-full bg-white rounded-xl p-12 border border-gray-100 text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:"ðŸ“„"}),e.jsx("div",{className:"text-gray-500 mb-4",children:"No documents found"}),e.jsx("button",{onClick:k,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Upload your first document"})]}):C.map(s=>{const t=L(s.type),n=w(s.expiry),i=N(s.expiry);return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-50",style:{backgroundColor:`${t.color}10`},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-lg",style:{backgroundColor:t.color,color:"white"},children:t.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-800",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500",children:t.label})]})]}),n&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-700",children:"Expired"}),i&&!n&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-amber-100 text-amber-700",children:"Expiring Soon"}),!n&&!i&&s.expiry&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-700",children:"Valid"})]})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Expiry Date"}),e.jsx("span",{className:`font-medium ${n?"text-red-600":i?"text-amber-600":"text-slate-700"}`,children:S(s.expiry)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Uploaded"}),e.jsx("span",{className:"text-slate-700",children:S(s.createdAt||s.created_at)})]}),s.notes&&e.jsx("div",{className:"pt-2 border-t border-gray-50",children:e.jsx("span",{className:"text-gray-500 text-xs",children:s.notes})})]})}),e.jsxs("div",{className:"px-4 py-3 bg-gray-50 flex items-center justify-between",children:[e.jsx("button",{onClick:()=>O(s),className:"px-3 py-1.5 text-sm font-medium text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",children:"Edit"}),e.jsx("button",{onClick:()=>F(s.id),className:"px-3 py-1.5 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:"Delete"})]})]},s.id)})}),T&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:c}),e.jsxs("div",{className:"relative bg-white rounded-2xl w-full max-w-lg shadow-2xl",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:d?"Edit Document":"Upload Document"}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-100 rounded-lg text-gray-400",children:"âœ•"})]})}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Document Type"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:f.map(s=>e.jsxs("button",{type:"button",onClick:()=>o(t=>({...t,type:s.id})),className:`p-3 rounded-xl border-2 transition-all ${a.type===s.id?"border-indigo-500 bg-indigo-50":"border-gray-100 hover:border-gray-200"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:s.icon}),e.jsx("div",{className:"text-xs font-medium text-gray-700",children:s.label})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Document Name *"}),e.jsx("input",{type:"text",value:a.name,onChange:s=>o(t=>({...t,name:s.target.value})),placeholder:"e.g., US Passport, Schengen Visa",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiry Date"}),e.jsx("input",{type:"date",value:a.expiry,onChange:s=>o(t=>({...t,expiry:s.target.value})),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),!d&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload File"}),e.jsxs("div",{onClick:()=>{var s;return(s=m.current)==null?void 0:s.click()},className:"border-2 border-dashed border-gray-200 rounded-xl p-6 text-center cursor-pointer hover:border-indigo-400 hover:bg-indigo-50/50 transition-colors",children:[e.jsx("input",{ref:m,type:"file",accept:".pdf,.jpg,.jpeg,.png,.doc,.docx",onChange:s=>o(t=>{var n;return{...t,file:((n=s.target.files)==null?void 0:n[0])||null}}),className:"hidden"}),a.file?e.jsx("div",{className:"text-indigo-600 font-medium",children:a.file.name}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“¤"}),e.jsx("div",{className:"text-gray-500",children:"Click to upload or drag and drop"}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"PDF, JPG, PNG, DOC (max 10MB)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:a.notes,onChange:s=>o(t=>({...t,notes:s.target.value})),placeholder:"Additional notes...",rows:3,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none"})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-100 flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:c,className:"px-5 py-2.5 border border-gray-200 rounded-xl text-gray-600 hover:bg-gray-50 font-medium",children:"Cancel"}),e.jsx("button",{onClick:d?A:$,className:"px-5 py-2.5 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 font-medium",children:d?"Save Changes":"Upload Document"})]})]})]})]})})}export{V as default};
