import{u as A,r as o,j as e}from"./index-B4FkT-MR.js";const d="http://localhost:5000";function O(){const f=A(),[x,j]=o.useState([]),[h,v]=o.useState([]),[m,g]=o.useState(!0),[N,a]=o.useState(!1),[t,l]=o.useState({destination:"",type:"political",severity:"medium",title:"",description:""});o.useEffect(()=>{c()},[]);async function c(){try{g(!0);const[s,r]=await Promise.all([fetch(`${d}/api/risk/advisories`),fetch(`${d}/api/risk/travelers`)]);if(s.ok){const i=await s.json();i.success&&j(i.advisories||[])}if(r.ok){const i=await r.json();i.success&&v(i.travelers||[])}}catch(s){console.warn("fetchData failed",s)}finally{g(!1)}}async function w(){if(!t.title||!t.destination){alert("Please fill in title and destination");return}try{(await fetch(`${d}/api/risk/advisories`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok&&(await c(),a(!1),l({destination:"",type:"political",severity:"medium",title:"",description:""}))}catch(s){console.error("createAdvisory failed",s)}}async function k(s){try{await fetch(`${d}/api/risk/travelers/${s}/checkin`,{method:"POST"}),await c()}catch(r){console.error("checkIn failed",r)}}async function C(s){if(window.confirm("Trigger SOS alert? This will notify the emergency team."))try{await fetch(`${d}/api/risk/travelers/${s}/sos`,{method:"POST"}),await c()}catch(r){console.error("SOS failed",r)}}async function S(s){try{await fetch(`${d}/api/risk/travelers/${s}/toggle-optin`,{method:"POST"}),await c()}catch(r){console.error("toggleOptIn failed",r)}}const n={high:{bg:"rgba(239,68,68,0.1)",color:"#dc2626"},medium:{bg:"rgba(245,158,11,0.1)",color:"#d97706"},low:{bg:"rgba(16,185,129,0.1)",color:"#059669"}};return e.jsx("div",{className:"min-h-screen font-sans",style:{backgroundColor:"#f8fafc"},children:e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsx("header",{className:"mb-8",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"Risk & Safety"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Travel advisories and traveler safety tracking"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>a(!0),className:"px-5 py-2.5 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors flex items-center gap-2",children:[e.jsx("span",{children:"+"})," New Advisory"]}),e.jsx("button",{onClick:()=>f(-1),className:"px-4 py-2.5 border border-gray-200 rounded-lg text-gray-600 hover:bg-gray-50 font-medium",children:"â† Back"})]})]})}),N&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>a(!1)}),e.jsxs("div",{className:"relative bg-white rounded-2xl w-full max-w-lg shadow-2xl",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Create New Advisory"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Add a travel advisory for a destination"})]}),e.jsx("button",{onClick:()=>a(!1),className:"p-2 hover:bg-gray-100 rounded-lg text-gray-400",children:"âœ•"})]})}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),e.jsx("input",{type:"text",value:t.title,onChange:s=>l({...t,title:s.target.value}),placeholder:"e.g., Weather Alert - Typhoon Warning",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Destination *"}),e.jsx("input",{type:"text",value:t.destination,onChange:s=>l({...t,destination:s.target.value}),placeholder:"e.g., Tokyo, Japan",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),e.jsxs("select",{value:t.type,onChange:s=>l({...t,type:s.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"political",children:"ðŸ›ï¸ Political"}),e.jsx("option",{value:"weather",children:"ðŸŒªï¸ Weather"}),e.jsx("option",{value:"health",children:"ðŸ¥ Health"}),e.jsx("option",{value:"security",children:"ðŸ”’ Security"}),e.jsx("option",{value:"other",children:"ðŸ“‹ Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Severity"}),e.jsx("div",{className:"flex gap-2",children:["low","medium","high"].map(s=>e.jsx("button",{type:"button",onClick:()=>l({...t,severity:s}),className:"flex-1 py-2.5 rounded-lg text-sm font-semibold border-2 transition-all",style:{background:t.severity===s?n[s].bg:"white",color:t.severity===s?n[s].color:"#6b7280",borderColor:t.severity===s?n[s].color:"#e5e7eb"},children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:t.description,onChange:s=>l({...t,description:s.target.value}),placeholder:"Provide details about the advisory...",rows:4,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none"})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-100 flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>a(!1),className:"px-5 py-2.5 border border-gray-200 rounded-xl text-gray-600 hover:bg-gray-50 font-medium",children:"Cancel"}),e.jsx("button",{onClick:w,className:"px-5 py-2.5 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 font-medium",children:"Create Advisory"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-5 border-b border-gray-100 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-lg",style:{background:"linear-gradient(135deg, #f59e0b, #d97706)",color:"white"},children:"âš ï¸"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-800",children:"Travel Advisories"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[x.length," active advisories"]})]})]}),e.jsx("div",{className:"p-5 max-h-[500px] overflow-y-auto",children:m?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin mb-4"}),e.jsx("p",{children:"Loading advisories..."})]}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-5xl mb-4",children:"ðŸ“‹"}),e.jsx("h4",{className:"text-lg font-semibold text-slate-700 mb-2",children:"No advisories yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first travel advisory"}),e.jsx("button",{onClick:()=>a(!0),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"+ Add Advisory"})]}):e.jsx("div",{className:"space-y-4",children:x.map(s=>{var r,i,p,b,u,y;return e.jsxs("div",{className:"p-4 rounded-xl border border-gray-100 hover:shadow-md transition-shadow",style:{backgroundColor:((r=n[s.severity])==null?void 0:r.bg)||"#f9fafb"},children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-800",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["ðŸ“ ",s.destination]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-semibold",style:{backgroundColor:(i=n[s.severity])==null?void 0:i.bg,color:(p=n[s.severity])==null?void 0:p.color},children:(b=s.severity)==null?void 0:b.toUpperCase()})})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:s.description}),e.jsx("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-200/50",children:e.jsxs("span",{className:"text-xs text-gray-500",children:[((u=s.type)==null?void 0:u.charAt(0).toUpperCase())+((y=s.type)==null?void 0:y.slice(1))," â€¢ ",new Date(s.createdAt).toLocaleDateString()]})})]},s.id)})})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-5 border-b border-gray-100 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-lg",style:{background:"linear-gradient(135deg, #10b981, #059669)",color:"white"},children:"ðŸ‘¥"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-800",children:"Traveler Safety"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[h.length," travelers tracked"]})]})]}),e.jsx("div",{className:"p-5 max-h-[500px] overflow-y-auto",children:m?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin mb-4"}),e.jsx("p",{children:"Loading travelers..."})]}):h.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-5xl mb-4",children:"ðŸ‘¤"}),e.jsx("h4",{className:"text-lg font-semibold text-slate-700 mb-2",children:"No travelers tracked yet"}),e.jsx("p",{className:"text-gray-500",children:"Travelers will appear here when they opt-in to tracking"})]}):e.jsx("div",{className:"space-y-4",children:h.map(s=>{var r;return e.jsxs("div",{className:"p-4 rounded-xl border border-gray-100 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white font-semibold",style:{background:"linear-gradient(135deg, #6366f1, #8b5cf6)"},children:((r=s.name)==null?void 0:r.charAt(0).toUpperCase())||"U"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-800",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email})]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.sosActive&&e.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700 animate-pulse",children:"ðŸš¨ SOS"}),e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-semibold ${s.optIn?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:s.optIn?"ðŸ“ Sharing":"ðŸ”’ Private"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["Last check-in: ",s.lastCheckIn?new Date(s.lastCheckIn).toLocaleString():"Never"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>k(s.id),className:"px-3 py-1.5 text-xs font-medium rounded-lg bg-green-100 text-green-700 hover:bg-green-200 transition-colors",children:"âœ“ Check-in"}),e.jsx("button",{onClick:()=>C(s.id),className:"px-3 py-1.5 text-xs font-medium rounded-lg bg-red-100 text-red-700 hover:bg-red-200 transition-colors",children:"ðŸš¨ SOS"}),e.jsx("button",{onClick:()=>S(s.id),className:"px-3 py-1.5 text-xs font-medium rounded-lg bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors",children:s.optIn?"Disable":"Enable"})]})]},s.id)})})})]})]})]})})}export{O as default};
